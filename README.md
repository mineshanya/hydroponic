##  ЛОГИКА РАБОТЫ КОНТРОЛЛЕРА
Изначально, с завода, в постоянной памяти(далее EEPROM) записаны ячейки byte со своим максимальным значением (255).  
При каждом включении идет обращение к EEPROM.  
Если при включение удается считать расписание из EEPROM,  
на дисплее отображается "Config loaded" и использоваться будет сохраненное ранее расписание.  
Если же это первое включение, на дисплее отображается "Defaults loaded" и использоваться будет стандартное расписание, которое можно настроить ниже.  
   После загрузки запускается цикл:  
       происходит актуализация состояния, в этот момент загорается индицирующий светодиод  
       по завершению обработки индицирующий светодиод гаснет и ардуино уходит в спячку на ~5 секунд  
   Если при подаче питания удерживать кнопку энкодера, произойдет сброс текущего времени на 12:00  
Если до подачи питания на модуле часов батарейка была разряжена/вынута, также произойдет сброс текущего времени на 12:00  
При сбросе времени индицирующий светодиод быстро мигает 5 раз, а на дисплее отображается "RTC RESET!" или "RTC lstpwr" соответственно  
  Чтобы попасть в меню, нужно в любой момент нажать и удерживать кнопку энкодера. Чтобы изменять значения, нужно крутить нажатый энкодер.  
  Логика подменю и меню:  
  В подменю изменения расписания полива, освещения и яркости пункт "Ok" отвечает за установку значений до следующей перезагрузки  
В подменю "Time" пункт "OK" задаст установленное время  
Пункт "Cancel" отменяет введение новых значений  
Чтобы новое расписание сохранилось и после перезагрузки, нужно в главном меню нажать "Save"  
Пункт "Load" загружает из EEPROM расписание  
Пункт "Reset" возвращает стандартное расписание, которое можно настроить ниже, а также записывает его в EEPROM  

##  ПОДКЛЮЧЕНИЕ ПЕРИФЕРИИ, ПИТАНИЕ, ОБЩАЯ СХЕМА
SDA - A4  
SCL, он же SCK - A5  
питать можно 3.3-5v напрямую через контакт VCC/5V, 7-15v через контакт VIN, 7-40v через пониж модуль LM2596S (его настроить на 5v и подать на контакты VCC/5V)  
потребляет 21-28мА, в зависимости от состояния  
5539 фоторезистор соединить напрямую с землей, подтягивающий резистор не нужен, можно любой, но тогда сумерки будут не в середине диапозона и точность будет ниже  
GND общий во всей системе, в т.ч. у приборов и у LM2596S  
Gate на мосфетах подтянуть 10кОм к земле, 220 Ом к ардуино (первая ножка)  
VCC для устройств подкл к "DRAIN" на мосфетах (серединка или верхний контакт)  
Устройства могут питаться любым напряжением, в т.ч. могут работать от 1 источника, тогда "DRAIN" на мосфетах можно сразу соединить  
Устройства подключать к Source на мосфетах (3я ножка), это будет их плюсовой контакт питания  
Можно поставить светодиоды для визуального контроля как вместе с мосфетами, так и вместо них  
   Светодиоды подключаются между GND и ардуино через резистор 220ом-3кОм(больше сопротивление=тусклее)  

##  ДЕБАГ
5 быстрых миганий - время было сброшено, стало 1/1/2020 12:00  
постоянные быстрые мигания - нет связи с часами  

##  НАСТРОЙКА ПИНОВ, К КОТОРЫМ ПОДКЛЮЧЕНА ПЕРИФЕРИЯ
|define|arduino pin|description|constrains|
|---|---|---|---|
|#define ENC_CLK_S1    |4 |      CLK/S1 - влияет на направление вращения,                            |допустимые пины 2-13, A0-A3, A6-A7  |
|#define ENC_DT_S2     |5 |      DT/S2 -  влияет на направление вращения,                            |допустимые пины 2-13, A0-A3, A6-A7  |
|#define ENK_key_SW    |3 |      key/SW - кнопка, замыкает GND,                                      |допустимые пины 2-13, A0-A3, A6-A7  |
|#define WTR_PIN       |11|      pin реле увлажнения, обычно A0,                                     |допустимые пины 2-13, A0-A3, A6-A7  |
|#define LGHT_PIN      |9 |      pin реле освещения, обычно A1,                                      |допустимые пины 2-13, A0-A3, A6-A7  |
|#define BR_SENS_PIN   |A3|      pin датчик освещенности, обычно A3,                                 |допустимые пины A0-A3, A6-A7  |
|#define IND_LED_PIN   |13|      pin светодиода-индикатора, обычно 13(распаян на плате)              |допустимые пины 2-13, A0-A3, A6-A7 | 
|#define OLED_en_pin   |2|       pin включения дисплея, если нужно задействовать, замыкаем на землю, |допустимые пины 2-13, A0-A3, A6-A7  |

##  РАСПИСАНИЕ ПО-УМОЛЧАНИЮ
|define|time|description|
|---|---|---|
|#define OLED_TIMEOUT  |10      |время в секундах до автовыключения дисплея, 1-240 сек, 0 горит всегда  |
|#define WTR_ON        |0       |время вкл полива (минуты), 0-59  |
|#define WTR_OFF       |5       |время выкл полива (минуты), 0-59  |
|#define LGHT_ON       |8       |время вкл света (часы), 0-23  |
|#define LGHT_OFF      |21      |время выкл света (часы), 0-23  |
|#define BRTNSS_ON     |40      |нижний порог % освещенности для вкл света, обычно 52, 0-100  |
|#define BRTNSS_OFF    |60      |верхний порог % освещенности для выкл света, обычно 52, 0-100  |
